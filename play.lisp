
(defmacro ignore-tags (&rest tags)
  `(progn
     ,@(loop for tag in tags 
          collect `(defmethod cl-who:convert-tag-to-string-list ((tag (eql ,tag)) attrs body body-fn)
                     (declare (ignore attrs))
                     (nconc (cons "" (funcall body-fn body)) (list ""))))))

(ignore-tags :html :head :body :blockquote)

(defvar *indentation* 0)
(defparameter *indentation-spaces* 4)

(defun n-spaces (n)
  (format nil "摸祜镳骘骝镯麸泔祆邈＼羽徙濠┅ㄤ彐躅轭溴铘瞟箦翩轭溴铘狒轱瞠瞽箴徙弩í轭溴铘狒轱瞽箴徙弩┅┅ㄤ彐磲泸痱彐轼翎珞é蝈篝翎珞啜痱镧括祜镳骘翎轭翎珞泔祆邈ㄤ弩趄蹉趱蜷铉忾钿翎绛钺礤镳糸镱翎ㄩ铛礅弪镳糸镱啜溴骓弭栾沆麒锖泔铞弪舡翎绛麸篝蜷铉扉篝è翎ㄥ耢翎绛钺礤┅猸骖ㄤ邈灬蝈ㄩ珙矧岍ㄩ钿孱镳糸镱钽镱ㄣ镱ㄦ矧磲铋⒒立轭溴铘狒轱瞠ㄦ躅汜祆猸骖猢扉篝ㄦ矧磲铋ア┅┅啜溴骓弭栾沆麒锖泔铞弪舡翎绛麸篝蜷铉扉篝è翎ㄥ耢翎绛钺礤┅猸骖ㄤ邈灬蝈ㄩ珙矧岍钽镱ㄣ镱ㄦ矧磲铋立ㄩ镳糸镱⒒轭溴铘狒轱瞠ㄦ躅汜祆猸骖猢扉篝ㄦ矧磲铋ア┅┅┅┅痱彐轼翎珞ê璞癌ê璨暴ê璩博换泔眄孱舡秕鏖翳箦黹泔祜犷轭溴铘轭溴铘狒轱瞽箴徙弩ê璐畅ê冤换泔眄孱舡秕鏖翳箦黹泔祜犷轭溴铘轭溴铘狒轱瞠ê痱紊泰换滹瞌泔眄孱舡秕怩轭溴铘轭溴铘狒轱瞠ㄤ彐躅翎祀é镳糸镱犰篝蝈犴篝犷溽蜾秕麴豸┅ㄣ飙麒锖鏖翳梏盱秕麴豸篝蝈犴ê梏盱ê桢徜呼轸戾⑼徙蝻螈ê怙澌ê璞⑼徙蝻螈ê璨⑸铘蝻漉泗轱睥ê⑼徙蝻狎痱镧蜥眢翳狒黩轸痱镧蜥眢馏嗅蹯球徼犴黩轸弩轭项涕箴êè衡祜汶聃雉横趑蜷怩糸镱⑿狨球徼犴⑻轶皈磲泸驷汩扉豉犰祜黧秕麸溴骈铄镳弪狒矧翳狒狎轫痨屙孱翦怡趄犷箧矧磲糸镱澡溴骈铋糸镱镦磲泸轶弩箦铘獒祆骢钽糸镱翳狒珏铄蜥翦涕箴泔溴礓狍杌痱镧蜥翳狒黩轸弩痱镧蜥眢┅ê璨⒃蜥铙骘蝽轭涕箴蔑溴轭麸涕箴蔑溴ê璩⒘氧殂砒犴痨澧ê璐⒛牌土靡礓狍杌溴骈铄磲泸铫ê痱ㄤ彐磲泸铛祆殒ㄡ蜱扉篝箦赳狎ь殪┅ê璐⑸铞镫磲泸铫ê痱铛祆殒ê璐⒃桢泔眇殪弪箦弩孩ê痱箦赳ь殪ê璩⑼撩蚁咆辛文礓狍堍序弼殄鬈骘歪泸矬ê⑼撩蚁咆辛文轶骢钽糸镱翳狒屮疳钿磲泸轭鲲汜糸镱留翳遗刑汜祆轸鏖翳翳聃雉邃箫躜沐骘蝽孩ê痱磲泸镥疳钿Ж铛祆殒┅ê⒆轸犹赏秕汜瘐秕沲蝮矧镱翳镳孱轭疳蝈铘桢箝镦翳骘蝽犷痱弩铆蓬翦虍澡狒翳遽簌麽麸磲泸镥疳钿砰翳弪麽秕ъ箦痱弼殄镦翳泔溴翳泔眇殪弪鏖祆痱镢弩螽ê璨⒛殒驽蝈钽弩忮赭邋骢钽糸镱犷磲泸铫ê璩⑸铞镫轭磲泸犷轭鲲腴铉骢钽糸镱栳鲥翳筢礤簌铘狲ê⒆泔蹯溴骈铄骢钽糸镱矧磲泸汜祆邃尤献釉疑吻孩ê痱ㄤ彐躅箬秣篝蜷铉螬痱轭螬ㄤ彐磲泸箬秣篝蜷铉螬扉篝ю蜷铘螬ê⒆濮轭鲲脲彘翳弪镱翳筢礤麽孩ê痱箬秣篝蜷铉堍桢祆铿黠蜢滠换歪泸矧骢钽糸镱轭鲲汜糸镱竣ê璩⑵躅泗轱铙狎骈蝮舡沆狍镡赍泗螽ê璐⑼狴忮疳篌邃狍狎珲礤铘麸犷雉桢骢钽糸镱ê痱磲疸狎ЙЖ畅ê璐⑼狴忮篝矧邃轭鲠蜷徕戾ê璩⑼徙蝻狎轭篝蝓泗轱铙骘翳疳蝮弪ê璐⑼狴铒忮疳篌邃狍狎珲礤铘矧篝矧邃轭鲠蜷徕戾ê璐⒛轶狃疱狎徭翦疳蝮轭蝈痨徙邃怡翳屙轸翦泔溴ê痱戾è骢钽糸镱Й┅磲疸狎骢钽糸镱Ж畅┅ㄤ彐磲泸睐痨躞é蝈篝狎珞扉篝п痧禊Й狎珞┅磲疸狎ы痨躞Ж畅骄乓蚁唾刑沼轶瞌骢钽糸镱ê璩⒘蜱蹴孱趔狎弼犰踽翦溟骀弪孱綮ê璐⑵躅泗轱狎珲礤铘狎弼犰踽翦忮骘蝈翳骢钽糸镱轶汜祆邃ê痱ǐí畅ê⒃桢骢钽糸镱Й蝈沐轹弩赭狎珲礤铘蟋犷懂ê璐⑼徙蝻狎珲礤铘狎疳篌邃麸翳磲泸躅弼犰踽翦洚ê痱睐痨躞í畅ê⒃桢磲泸唾刑沼蝈沐轹弩赭狎珲礤铘蟋犷翳扉篝í畅ê璨⑻轶箫躜沐泔溴轶瞌翦轸疳蝮趄邋镦涕箴镡赍泗螽ê⒃桢泔溴翳狒秕黩轸轶犷屮翦蝾犰蝈痱弩孱翎糸镱镦翳疳蝮趄邋澡泔溴翳狒翳泔眇殪弪镳弪狒弩镱轶犷轭翦蝾犰蝈痱弩孱翎糸镱磲溴躔镦涕箴镡赍泗蟋铒翦舢ê璩⒃桢疳蝮趄邋汜忮怩殪怡蝈徜轭翦翳狒秕豉疱ê痱痱轭堍桢祆铿黠蜢滠ê璩⒃桢疳蝮趄邋汜牾篝狍麇祆忮怩殪怡汜祆轭骢钽糸镱翳狒秕黩轸瀹ê痱扉篝ю蜷铘堍桢祆铿黠蜢滠ê璩⒃桢泔眇殪弪滹弩瞌溟篝轭珲轶忮赭邋翳矧殓轭镦翳疳蝮趄邋ê璨⑼徙蝻屮疳铙轱堍糸礤堍鲶碰犰踽糸镱堍糸礤堍è衡祜汶聃雉横趑蜷怩糸镱⑿狨球徼犴⒃桢磲泸镥疳铙轱篝屦溴犰鏖翳屮痱弩箝镱蟋犷翳弼犰踽糸镱篝屦溴犰鏖翳翳彘鲠祯弩ê璩⑼徙蝻屮疳铙轱栳痧孱骈蝮衄麒殪翳泔溴轶忮轭蝈徜ê璐⒘磲泸轭鲲汜糸镱轶蝈痨徙邃怡翳涕箴翳狒轸痱镤蹉弩ê璐⑼徙蝻屮疳铙轱溴犰鏖翳箫躜沐泔溴铒痱镧蜥溽翎ê痱ㄤ彐磲泸徜洵镱铛礅弪ㄩㄥ耢铛礅弪背扉篝у蝌矧堍忉祯汶≤扉篝П铛礅弪┅ㄡ滗镱辈ㄡ滗镱背换彭轸翳弪蝻骘蝽戾铛背ㄡ滗镱铛愆换彭轸翳鲍骘蝽ê璩⑴鲠祯狒轱栳痧孱灬翦颥磲忮眭汨灬翦虍ê璐⒘磲泸轭鲲脲狒翳遗刑轶弼犰踽翦轫礤溟狒屐徭翦磲泸镥疳铙轱睥ê璐⒘磲泸轭鲲脲轭箝溴骢钽糸镱溴骈铋糸镱轶弼犰踽翦麒孱翳骢钽糸镱轶汜祆邃ê璨⑼犭轭涕篝鏖翳箩汶聃雉澧ê⒃桢忉汶聃雉镳弪狒矧怩殪潴扉篝蟋牾篝扉脲翳骢钽糸镱躺釉犷列信文滹矧眭汨扉脲翳颜显箴邈獒镳弪狒矧滹弩箩汶聃雉磲忮盹蝈泔铞孱殄铘麸躞瀣箝钽轸轭瘐祜镫祜扉脲轸秕麴豸滹弩阵轭忉汶聃雉轶扉脲骈祆轭轭翦眇灬翦麸磲脲扉篝ê⒙徙腭躏翦磲脲磲泸矬遽箝弪麸黩轸犷蝈徜ê璩⒆轸栾豸轭翦蝠镬狒轱瞵忉汶聃雉黠螂牾篝扉脲聃雉澧ê⒃桢箦犰痱镤蹉翳筢礤扉篝孩ê痱啜悌Ж悌扉篝прсê璩⒀躏糸铉鏖翳轭翦蝠镬狒轱睥ê璐⒚镯磲轭翦蝠镬狒弩ê⒃桢泔眄镳弪狒矧堍躅聃雉弩堍翳铄骘蝽翳鲠祯镦麒殂轶轭箦螋邃轭麸翳扉篝狒翳狒痫轭舢ê痱戾è暴ㄢ博啜猢义篚祠博ê璐⒚镯磲留箝珙箴扉沐螈ê⒃桢泔眄狒箝珙镳弪狒矧犰箫翎脲翳鲠祯镦翳铄骘蝽麒殂眭篝忮扉篝躅戾篌轸镢沲蝮灬篝犷箴扉沐轸鲠祯弩轭麸翳蝈篚祠ê痱戾è扉篝Ж镱赭铹┅啜扉篝漓轶舂义篚祠è衔宰烯衔宰烯ê璨⒅狎獒忪汜痿躜澧ê璩⒃桢痱镡戾鏖翳鲠蜷徕戾汜痿躜瀹ê⑷弪麇泔铙趄蹉铄骒秣泔铘蝻葡祜镳族麽铘麸狯镩弼犰踽糸铉釉闲眭祠轲戾糸礤忮汜躞轸磲忮骘蝽鏖翳箝溴彐驽泗螽族泸遽翦祜汜鲠蜷徕戾躺蜕袁鏖翳翳鲠祯镦釉闲迈翳鲠蜷徕戾躺蜕轶汜痿躜邃ê痱ㄤ彐磲泸骘è鲠篝狎篝镳怙澌怙澌啜滹è鲠篝狎ū鲠颟扉黹篝镳┅è鲠扉黹舂棱镤┅ê⑸翳痱镧蜥眄弪黩轸弩ê痱ㄦ矧卑痱轭┅êⅦ栝汨磲泸镥疳钿轭麸ê痱南èū丞ㄌ赏稍卑┅è躺蜕冤ㄐ疑卧丞êⅣ桢鲠蜷徕戾汜痿躜轶瞌痱镡戾懋ê⒃桢痱镡戾镢沲蝮麒孱翳痱镧蜥眄弪栳痧孱麸躞翳筢礤鲠蜷徕戾钺礤轭翳怙澌镦翳祜镳ê痱戾è扉黹床┅ㄦ矧卑ㄦ矧磲堍宁ボ扉黹舂ㄤ邈扉黹í卑┅┅ê⒃桢躺蜕翳狒痱轭翦犷溴泸屙孱翦狎翳鲠蜷徕戾泸遽翦轭翳南铒轭翳膛狍翳痱镧蜥眄弪屮疱泗螽ê璩⑶盼淤廷ê璐⑶盼淤泸遽翦铄簌礅镬鏖翳珲狎犷翦邃躅轳蹂殇孱糸豉ê璐⒆汜躞翳狒铄簌礅镬筢驽禊轭屙轸翦泔溴鏖翳铒泔祆轶轱铙痫篌殁戾ê⑷弪瀣躺蜕轶泸遽翦洮漉蜷铉磲泸镥疳铙轱瞵秕趔殇镦翳屙轸翦泔溴婶铄鲥躞邃轭翳屙轸翦泔溴阻狒躞邃轭篝遽轶翳蝈篚祠镦翳汜祆麸桥斡偻痱镡徕禊箫礤翳轭扉脲：遣炒尝ê痱ㄤ彐磲泸骘è鲠篝狎篝镳怙澌怙澌戾è扉黹ㄧ孱簌堍躺蜕原堍┅啜滹è鲠篝狎ū鲠颟ì扉黹篝镳┅è鲠扉黹舂棱镤┅戾è扉黹床┅ㄦ矧卑ㄤ邈扉黹舂┅换物篚蝠蜷箦螈┅鲠祯弩┅